<!doctype html>
<html lang="en">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<style>

  .margin-bottom {
      margin-bottom: 15px ;
  }

  .nav{
    max-height: 30px;
    overflow-y: scroll;
  }

  .blinking{
	animation:blinkingText 0.5s infinite;
  }
  
  @keyframes blinkingText{
	0%  {   color: #000;	    }
	49% {	color: transparent;	}
	50% {	color: transparent;	}
	99% {	color: transparent;	}
	100%{	color: #000;	    }
  }

</style>

<script src="fabric.js"></script>
<script src="util.js"></script>
<script src="node.js"></script>
<script src="tree.js"></script>
<script src="board.js"></script>
<script src="guiBoard.js"></script>
<script src="myTbox.js"></script>

    
<div class="jumbotron text-center ">
	<h1>Monte Carlo Tree Search Algorithm </h>
		<h3> Ravi Saripalli </h3> <h4> 26th November 2018 </h4>
		<p>	A test bed with the simple Tic Toc Toe game </p>
</div>

<div class="container">
  <div class="row">

	   <div class="col-md-3">
	   <div class="row">
		  <h3>Parameters</h3>
			 <label class="col-sm-8">No. of Expolorations:</label>
			 <input class="col-sm-4 margin-bottom" type="number" min=0 step=10  id="nexp">

			 <label class="col-sm-8"> No. of Simulations:</label>
			 <input class="col-sm-4 margin-bottom" type="number" min=0 step=10 id="nsim">

			 <label class="col-sm-8">Exploration Factor:</label>
			 <input class="col-sm-4 margin-bottom" type="number" min=0 max=2 step=0.1 id="utcf">

			 <button id="simbtn" type="button" 
				 class="btn btn-primary col-sm-6">simulate</button>
         </div>

           <div class="row">
		     <h3>Output</h3>
		     
		     <label class="col-sm-8">Total Nodes in the Tree:</label>
		     <label class="col-sm-4" id="lblnodes"></label>

		     <label class="col-sm-8">Percent Wins :</label>
		     <label class="col-sm-4" id="lblWins"></label>
		     
		     <button id="btnplay" type="button" 
				 class="btn btn-primary col-sm-6" >play</button>
		   </div>
		</div>


	   <div class="col-md-9 margin-bottom" >
		  <h3>Tic Toc Toe</h3>
		  <canvas id="canvas">  </canvas>	
		   <div class="col-md-12 margin-bottome" id="outcome" >
		   </div> 
	  </div>

  </div> 

  <div class=row>
      <h3>Status</h3>
    <div id="status" class=well rounded style="height:60px; overflow: scroll">
    </div>
  </div>

</div>
<script>
   
 var canvas = new fabric.Canvas("canvas", {backgroundColor: 'lightyellow',
                                              width: 400, height: 400});
 var gb = new guiBoard (canvas) ;

  // var my = new myTbox ("Ravi Sankar", 150, 100);
  //my.group.top = 100 ;  my.group.left = 100 ;  my.flashtxt(true);


var game = {} ;

    $(document).ready(function() {

      $("#nsim").val(100) ;
      $("#nexp").val(100) ;
      $("#utcf").val(0.2) ;
    }); // end of Initial Set up


$("#btnplay").click(function(){
for(let i=0 ; i<1 ; i++) {
 let win = game.learntPlay();
 console.log(win);
 if (win) $("#outcome").html("I Win");
}
});


$("#simbtn").click(function() {
  
  status ("Started Tree Search") ;
    game = new tree(); game.UTCF =  $("#utcf").val() ;
   console.log("Root Node: \n", game.root);
  
  for (let i=0 ; i < $("#nexp").val() ; i++) {  
     game.select() ;  
     for(let j=0 ; j < $("#nsim").val() ; j++) {   
        game.simulate() ;   
        game.propagate() ;   
  }};

  status ("Tree Search Completed") ;
  $("#lblnodes").html(game.NodeSet.length) ;

}); // Simulation button click 



// Script that provides the user interface
function status(msg) { // Add messages to status
    // an easier way is to use innerHTML but that is not safe!!!
    var br = document.createElement("br") ;
    var d = new Date();    var n = d.toLocaleString();
    var content = document.createTextNode(n + ": " + msg) ; 
    $("#status").append(br, content) ;
}

</script>

</html>

